<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kayla Kauffman">
<meta name="dcterms.date" content="2023-11-29">
<meta name="description" content="simulate a probability distribution of risk">

<title>Kayla Kauffman - Simulation of Realized Infection Risk</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Kayla Kauffman</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../publications.html" rel="" target="">
 <span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../research.html" rel="" target="">
 <span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html" rel="" target="">
 <span class="menu-text">Blog</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto tools-wide">
    <a href="https://github.com/kmkauffm" title="Github" class="quarto-navigation-tool px-1" aria-label="Github"><i class="bi bi-github"></i></a>
    <a href="mailto:kaylakauffman@ucsb.edu" title="Email" class="quarto-navigation-tool px-1" aria-label="Email"><i class="bi bi-envelope"></i></a>
    <a href="../../qrcode.html" title="qrcode" class="quarto-navigation-tool px-1" aria-label="qrcode"><i class="bi bi-share"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Simulation of Realized Infection Risk</h1>
                  <div>
        <div class="description">
          simulate a probability distribution of risk
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">R</div>
                <div class="quarto-category">code</div>
                <div class="quarto-category">simulations</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p><a href="https://https://kmkauffm.github.io/">Kayla Kauffman</a> <a href="https://orcid.org/0000-0002-4897-9428" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 29, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background">Background</a></li>
  <li><a href="#make-a-risk-map" id="toc-make-a-risk-map" class="nav-link" data-scroll-target="#make-a-risk-map">Make a Risk Map</a></li>
  <li><a href="#simulate-movement" id="toc-simulate-movement" class="nav-link" data-scroll-target="#simulate-movement">Simulate movement</a>
  <ul class="collapse">
  <li><a href="#brownian" id="toc-brownian" class="nav-link" data-scroll-target="#brownian">Brownian</a></li>
  <li><a href="#levian-correlated-walks" id="toc-levian-correlated-walks" class="nav-link" data-scroll-target="#levian-correlated-walks">Levian (Correlated Walks)</a></li>
  </ul></li>
  <li><a href="#homeranges" id="toc-homeranges" class="nav-link" data-scroll-target="#homeranges">Homeranges</a></li>
  <li><a href="#assisgn-susceptibility" id="toc-assisgn-susceptibility" class="nav-link" data-scroll-target="#assisgn-susceptibility">Assisgn susceptibility</a></li>
  <li><a href="#trials" id="toc-trials" class="nav-link" data-scroll-target="#trials">trials</a>
  <ul class="collapse">
  <li><a href="#replicate-that-many-times" id="toc-replicate-that-many-times" class="nav-link" data-scroll-target="#replicate-that-many-times">replicate that many times</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<p>Risk maps are used to describe the places where people (or animals) are most likely to be exposed to infectious disease. However, the time an individual spends in a place is not the only predictor of infection. The activity a person does in a location may influence if they are exposed to the disease, for example a person wearing shoes in an environment with a lot of soil transmitted helminths is at low infection risk because they are wearing shoes, thus not directly exposed to the contaminated soil. The person’s immunity or susceptibility to an infection also influences their infection risk.<br>
Before creating a model with real data mapping people’s land use to their infection status I want to build a simulation of how I think the model will work. First, I want to compare people that infection probabilities in people “vibrating” in place (Brownian motion) and to people traversing the landscape in corridors (Levian motion). I’ll then use this model to test how much susceptibility can vary before there is no correlation between the time people spend in risky places and their infection risk. <em>Asking: Do risk maps even work given individual heterogenetiy in susceptibility?</em></p>
</section>
<section id="make-a-risk-map" class="level2">
<h2 class="anchored" data-anchor-id="make-a-risk-map">Make a Risk Map</h2>
<p>Risk across the landscape likely has a lot of spatial autocorrelation and relates to underlying environmental features. Instead of simulating this, I am using the spDataLarge elevation raster data the Zion National Park area as the <em>risk map</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>riskmap <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="fu">system.file</span>(<span class="st">"raster/srtm.tif"</span>, <span class="at">package =</span> <span class="st">"spDataLarge"</span>))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">## change into utm so easier to do the simulated tracks</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>riskmap <span class="ot">&lt;-</span> <span class="fu">project</span>(riskmap, <span class="st">"EPSG:26912"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="do">## make values [0,1]</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>riskmap <span class="ot">&lt;-</span> riskmap<span class="sc">/</span><span class="fl">2891.000</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="do">## make resolution lower so things run quickly</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>riskmap <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(riskmap, <span class="at">fact=</span><span class="dv">5</span>, <span class="at">fun=</span><span class="st">"mean"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="do">## make square</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">vect</span>(<span class="fu">ext</span>(riskmap)<span class="sc">-</span><span class="dv">5000</span>, <span class="at">crs=</span><span class="fu">crs</span>(riskmap))</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>riskmap <span class="ot">&lt;-</span> <span class="fu">crop</span>(riskmap, tmp)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="do">## quick plot</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(riskmap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>riskmap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatRaster 
dimensions  : 79, 61, 1  (nrow, ncol, nlyr)
resolution  : 417.6664, 417.6664  (x, y)
extent      : 306074, 331551.7, 4116123, 4149119  (xmin, xmax, ymin, ymax)
coord. ref. : NAD83 / UTM zone 12N (EPSG:26912) 
source(s)   : memory
name        :      srtm 
min value   : 0.3725258 
max value   : 0.9733700 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## find dimensions of area so can choose step lengths</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>risk_bb <span class="ot">&lt;-</span> <span class="fu">ext</span>(riskmap)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># risk_bb[2]-risk_bb[1]</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># risk_bb[4]-risk_bb[3]</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="do">## ~35km x 43km</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="do">## make slightly smaller so indivdiuals not on edge</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>risk_bb <span class="ot">&lt;-</span> risk_bb <span class="sc">+</span> <span class="fu">c</span>(<span class="dv">5000</span>, <span class="sc">-</span><span class="dv">5000</span>, <span class="dv">5000</span>, <span class="sc">-</span><span class="dv">5000</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="do">## save cell size</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>cell_size <span class="ot">=</span> <span class="fu">res</span>(riskmap)[<span class="dv">1</span>]</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="do">## save crs</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>crs_risk <span class="ot">&lt;-</span> <span class="fu">crs</span>(riskmap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="simulate-movement" class="level2">
<h2 class="anchored" data-anchor-id="simulate-movement">Simulate movement</h2>
<p>https://cran.r-project.org/web/packages/SiMRiv/vignettes/SiMRiv.pdf</p>
<section id="brownian" class="level3">
<h3 class="anchored" data-anchor-id="brownian">Brownian</h3>
<p>Simulate vibrating, Brownian movement of individuals basically vibrating in place with each individuals’ starting location distributed throughout the risk map area</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## one type of movement with a random walk with step lengths relative </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>rand.walker <span class="ot">&lt;-</span> <span class="fu">species</span>(<span class="fu">state</span>(<span class="at">concentration =</span> <span class="dv">0</span>, <span class="co">#random</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">pwind =</span> <span class="fu">perceptualRange</span>(<span class="st">"gaussian"</span>, <span class="dv">1</span>),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">steplen =</span> <span class="dv">10</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">name =</span> <span class="st">"tight_random"</span>))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="do">## generate random starting points (might change to regular or increase n)</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="do">### avoid edges</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>aoi <span class="ot">&lt;-</span> <span class="fu">buffer</span>(<span class="fu">vect</span>(<span class="fu">ext</span>(riskmap)),<span class="sc">-</span><span class="dv">2000</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>aoi <span class="ot">&lt;-</span> <span class="fu">crop</span>(riskmap, aoi)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>start_coord <span class="ot">&lt;-</span> <span class="fu">spatSample</span>(aoi, </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>                          <span class="dv">100</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"random"</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">as.points =</span> <span class="cn">TRUE</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">values =</span> F)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(riskmap);<span class="fu">points</span>(start_coord)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">## need those as a nx2 matrix</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>start_coord_mat <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as.data.frame</span>(start_coord, <span class="at">geom=</span><span class="st">"xy"</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="do">## simulate single state walks of 1000 steps</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>sim.rw <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">simulate</span>(rand.walker, <span class="dv">1000</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">coords =</span> start_coord_mat[i,])</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  sim.rw[[i]] <span class="ot">&lt;-</span> <span class="fu">cbind</span>(tmp[,<span class="dv">1</span>], tmp[,<span class="dv">2</span>])</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="do">### make into vect</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>sim.rw.sp1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sim.rw, vect, <span class="at">crs =</span> crs_risk)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="do">## plot it</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(sim.rw.sp[[1]])</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(riskmap); lines(sim.rw[[1]])</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(riskmap); <span class="fu">invisible</span>(<span class="fu">lapply</span>(sim.rw, <span class="at">FUN =</span> lines))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="levian-correlated-walks" class="level3">
<h3 class="anchored" data-anchor-id="levian-correlated-walks">Levian (Correlated Walks)</h3>
<p>Need to make a resistance raster to get correlated walk</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>LevyWalker <span class="ot">&lt;-</span> <span class="fu">species</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">state.RW</span>() <span class="sc">*</span> <span class="dv">100</span> <span class="sc">+</span> <span class="dv">10</span>) <span class="sc">+</span> (<span class="fu">state.CRW</span>(<span class="fl">0.97</span>) <span class="sc">*</span> <span class="dv">500</span> <span class="sc">+</span> <span class="dv">50</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>, <span class="fu">transitionMatrix</span>(<span class="fl">0.005</span>, <span class="fl">0.001</span>))</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="do">## basemaps for resistance</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>landcover <span class="ot">&lt;-</span> <span class="fu">resistanceFromShape</span>(</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">system.file</span>(<span class="st">"doc/landcover.shp"</span>, <span class="at">package=</span><span class="st">"SiMRiv"</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>, <span class="at">res =</span> <span class="dv">50</span>, <span class="at">field =</span> <span class="st">"coverclass"</span>, <span class="at">mapvalues =</span> <span class="fu">c</span>(</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="st">"forest"</span> <span class="ot">=</span> <span class="fl">0.5</span>, <span class="st">"urban"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"dam"</span> <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>, <span class="st">"shrubland"</span> <span class="ot">=</span> <span class="fl">0.75</span>), <span class="at">background =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `landcover' from data source 
  `C:\Users\Kayla\AppData\Local\R\win-library\4.3\SiMRiv\doc\landcover.shp' 
  using driver `ESRI Shapefile'
Simple feature collection with 8 features and 1 field
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 684645.8 ymin: 4618784 xmax: 697081.3 ymax: 4639516
Projected CRS: WGS 84 / UTM zone 29N</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>river.shape <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_read</span>(<span class="fu">system.file</span>(<span class="st">"doc/river-sample.shp"</span>, <span class="at">package=</span><span class="st">"SiMRiv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `river-sample' from data source 
  `C:\Users\Kayla\AppData\Local\R\win-library\4.3\SiMRiv\doc\river-sample.shp' 
  using driver `ESRI Shapefile'
Simple feature collection with 220 features and 1 field
Geometry type: LINESTRING
Dimension:     XY
Bounding box:  xmin: 678213.6 ymin: 4606303 xmax: 698782.2 ymax: 4649171
Projected CRS: WGS 84 / UTM zone 29N</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## resistence surface</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>resistance <span class="ot">&lt;-</span> <span class="fu">resistanceFromShape</span>(<span class="fu">system.file</span>(<span class="st">"doc/river-sample.shp"</span>, <span class="at">package=</span><span class="st">"SiMRiv"</span>),</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">baseRaster =</span> landcover,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">buffer =</span> <span class="dv">100</span>, <span class="at">field =</span> <span class="dv">0</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">background =</span> <span class="fl">0.95</span>, <span class="at">margin =</span> <span class="dv">3000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `river-sample' from data source 
  `C:\Users\Kayla\AppData\Local\R\win-library\4.3\SiMRiv\doc\river-sample.shp' 
  using driver `ESRI Shapefile'
Simple feature collection with 220 features and 1 field
Geometry type: LINESTRING
Dimension:     XY
Bounding box:  xmin: 678213.6 ymin: 4606303 xmax: 698782.2 ymax: 4649171
Projected CRS: WGS 84 / UTM zone 29N</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># buffer here is just some magical function to convert river</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># order into a meaningful value in the [0, 1] range!</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(resistance, <span class="at">axes =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>resistance</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class      : RasterLayer 
dimensions : 921, 476, 438396  (nrow, ncol, ncell)
resolution : 50, 50  (x, y)
extent     : 676595.8, 700395.8, 4604716, 4650766  (xmin, xmax, ymin, ymax)
crs        : NA 
source     : memory
names      : layer 
values     : 0, 1  (min, max)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">## change that to be in the same spot as the riskmap</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>new.resist <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="at">extent=</span><span class="fu">ext</span>(aoi),</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">nrow=</span><span class="fu">dim</span>(resistance)[<span class="dv">1</span>], <span class="at">ncol=</span><span class="fu">dim</span>(resistance)[<span class="dv">2</span>],</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">crs =</span> crs_risk,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">vals =</span> <span class="fu">values</span>(resistance))</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>new.resist <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(new.resist, <span class="at">fact =</span> <span class="dv">10</span>, <span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new.resist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## new starting coords in areas of low resistance so don't get stuck</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>init <span class="ot">=</span> <span class="fu">xyFromCell</span>(new.resist, <span class="fu">sample</span>(<span class="fu">which</span>(<span class="fu">values</span>(new.resist) <span class="sc">&lt;</span><span class="fl">0.2</span>), <span class="dv">100</span>, <span class="at">replace=</span>T))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="do">## simulate</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>sim.rw2 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">simulate</span>(LevyWalker, <span class="dv">1000</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">resist =</span> <span class="fu">raster</span>(new.resist),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">coords =</span> init[i,])</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  sim.rw2[[i]] <span class="ot">&lt;-</span> <span class="fu">cbind</span>(tmp[,<span class="dv">1</span>], tmp[,<span class="dv">2</span>])</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="do">### make into vect</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>sim.rw.sp2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sim.rw2, vect, <span class="at">crs =</span> crs_risk)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="do">## plot it</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(riskmap); <span class="fu">invisible</span>(<span class="fu">lapply</span>(sim.rw2, <span class="at">FUN =</span> lines))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="homeranges" class="level2">
<h2 class="anchored" data-anchor-id="homeranges">Homeranges</h2>
<p>for each individual calculate homerange (KD)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">## grid of study area</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">vect</span>(<span class="fu">ext</span>(riskmap), <span class="at">crs=</span>crs_risk)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>studygrid <span class="ot">&lt;-</span> SpatialKDE<span class="sc">::</span><span class="fu">create_raster</span>(<span class="fu">st_as_sf</span>(tmp),</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">cell_size =</span> cell_size)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="do">## make points into sf</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>sim1sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(sim.rw.sp2[[<span class="dv">1</span>]], <span class="at">geom=</span><span class="st">"xy"</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="do">## find kde</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>kde <span class="ot">&lt;-</span> SpatialKDE<span class="sc">::</span><span class="fu">kde</span>(sim1sf, <span class="at">band_width =</span> <span class="dv">10000</span>, <span class="at">scaled =</span> T, <span class="at">grid =</span> studygrid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              </code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">## crop to area where the individual was so not tiny</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>kde.sm <span class="ot">&lt;-</span> <span class="fu">crop</span>(kde, <span class="fu">st_buffer</span>(sim1sf, <span class="dv">2000</span>))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>risk.sm <span class="ot">&lt;-</span> <span class="fu">crop</span>(riskmap, <span class="fu">st_buffer</span>(sim1sf, <span class="dv">2000</span>))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="do">## calculate risk</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>kde.risk <span class="ot">&lt;-</span> <span class="fu">rast</span>(kde.sm)<span class="sc">*</span>risk.sm</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="do">## check in ball park</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">values</span>(risk.sm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 259.9122</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">values</span>(<span class="fu">rast</span>(kde.sm)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01816479</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">values</span>(risk.sm)<span class="sc">*</span><span class="fu">values</span>(<span class="fu">rast</span>(kde.sm)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01323637</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">values</span>(kde.risk))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01323637</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="do">## plots to demo</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatraster</span>(<span class="at">data=</span>risk.sm) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option=</span><span class="st">"A"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"landscape risk"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatraster</span>(<span class="at">data=</span><span class="fu">rast</span>(kde.sm)) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option=</span><span class="st">"A"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"exposure"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatraster</span>(<span class="at">data=</span>kde.risk) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option=</span><span class="st">"A"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"inf. probability"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### then redo on study grid so</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tmp, studygrid, sim1sf, kde, kde.sm, risk.sm, kde.risk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>then multiply their homerange by the “risk” in each cell</p>
<p>Put that in a function and run for everyone</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="do">## make a function</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>measure_risk <span class="ot">&lt;-</span> <span class="cf">function</span>(X, riskmap){</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">## grid of study area</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">vect</span>(<span class="fu">ext</span>(riskmap), <span class="at">crs=</span>crs_risk)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  studygrid <span class="ot">&lt;-</span> SpatialKDE<span class="sc">::</span><span class="fu">create_raster</span>(<span class="fu">st_as_sf</span>(tmp),</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">cell_size =</span> cell_size)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">## make points into sf</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  sim1sf <span class="ot">&lt;-</span> <span class="fu">lapply</span>(X, st_as_sf, <span class="at">geom=</span><span class="st">"xy"</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="do">## find kde</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  kde <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sim1sf, SpatialKDE<span class="sc">::</span>kde, <span class="at">band_width =</span> <span class="dv">100</span>, <span class="at">scaled =</span> T, <span class="at">grid =</span> studygrid)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="do">## convert Raster to SpatRast</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  kde <span class="ot">&lt;-</span> <span class="fu">lapply</span>(kde, rast)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="do">## multiply time in cell (kde) * cell's risk</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  new <span class="ot">&lt;-</span> <span class="fu">lapply</span>(kde, <span class="cf">function</span>(i) i<span class="sc">*</span>riskmap)</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="do">## sum of values in each layer are individual's risk</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  indiv_risk <span class="ot">&lt;-</span> <span class="fu">lapply</span>(new, <span class="cf">function</span>(i) <span class="fu">sum</span>(<span class="fu">values</span>(i), <span class="at">na.rm=</span>T))</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="do">## return a vector</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>(indiv_risk)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Find probabily of expsoure for each individual</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              

Done: [--------------------------------------------------------------------] .
Done: [====================================================================] .
                                                                              </code></pre>
</div>
</div>
<p>Values in random walk</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="do">## look at some of the values</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>indiv_risk1[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.03092283 0.01558403 0.04232516 0.05219774 0.03587051 0.02589272
 [7] 0.01809209 0.15778400 0.10425742 0.02810025</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(indiv_risk1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.004528794 0.189178801</code></pre>
</div>
</div>
<p>Values in corridor walk</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>indiv_risk2[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.03149273 0.04095521 0.01706546 0.01999374 0.01930194 0.04478892
 [7] 0.09564420 0.02857252 0.01897320 0.06463020</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(indiv_risk2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0008798587 0.1002468783</code></pre>
</div>
</div>
</section>
<section id="assisgn-susceptibility" class="level2">
<h2 class="anchored" data-anchor-id="assisgn-susceptibility">Assisgn susceptibility</h2>
<p>individuals should have variable susceptiblity so that not everyone’s probabilty of infection equals their sum</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>susceptbility <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">100</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>dataframes for the 2 types of exposures</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>rw_risk <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="dv">100</span><span class="sc">:</span><span class="dv">199</span>,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">exp_risk =</span> indiv_risk1,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">susceptbility =</span> susceptbility</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>cw_risk <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="dv">100</span><span class="sc">:</span><span class="dv">199</span>,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">exp_risk =</span> indiv_risk1,</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">susceptbility =</span> susceptbility</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="trials" class="level2">
<h2 class="anchored" data-anchor-id="trials">trials</h2>
<p>Compare probability of infection as a function of susceptibility alone (i.e.&nbsp;indiv stochasiticity; Null) to susceptibility * exposure risk (i.e.&nbsp;does adding info of exposure risk help)?? Not sure where I am going here….need to reread note on the origional idea</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="do">## random walk indiv's should just correlate with background (e_inf)</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>rw_risk<span class="sc">$</span>s_inf <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="dv">1</span>, rw_risk<span class="sc">$</span>susceptbility<span class="sc">*</span><span class="fu">mean</span>(rw_risk<span class="sc">$</span>exp_risk))</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>rw_risk<span class="sc">$</span>e_inf <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="dv">1</span>, rw_risk<span class="sc">$</span>susceptbility<span class="sc">*</span>rw_risk<span class="sc">$</span>exp_risk)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rw_risk) <span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>exp_risk, <span class="at">y=</span>s_inf))<span class="sc">+</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x=</span>exp_risk, <span class="at">y=</span>s_inf, <span class="at">col=</span><span class="st">"without risk"</span>),</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">col=</span><span class="st">"#619CFF"</span>,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">se=</span>F,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"glm"</span>,</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">method.args=</span><span class="fu">list</span>(<span class="at">family=</span><span class="st">"binomial"</span>)) <span class="sc">+</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Exposure risk"</span>, <span class="at">y =</span> <span class="st">"infection"</span>,</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="cn">NULL</span>,</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Susceptibility only"</span>)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rw_risk) <span class="sc">+</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>exp_risk, <span class="at">y=</span>e_inf))<span class="sc">+</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x=</span>exp_risk, <span class="at">y=</span>e_inf),</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">col=</span><span class="st">"#F8766D"</span>,</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">se=</span>F,</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"glm"</span>,</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">method.args=</span><span class="fu">list</span>(<span class="at">family=</span><span class="st">"binomial"</span>)) <span class="sc">+</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Exposure risk"</span>, <span class="at">y =</span> <span class="st">"infection"</span>,</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="cn">NULL</span>,</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Susceptibility * Risk"</span>)</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rw_risk) <span class="sc">+</span></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x=</span>exp_risk, <span class="at">y=</span>s_inf, <span class="at">col=</span><span class="st">"without risk"</span>),</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">se=</span>F,</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"glm"</span>,</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">method.args=</span><span class="fu">list</span>(<span class="at">family=</span><span class="st">"binomial"</span>)) <span class="sc">+</span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x=</span>exp_risk, <span class="at">y=</span>e_inf, <span class="at">col=</span><span class="st">"with risk"</span>),</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>              <span class="at">se=</span>F,</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"glm"</span>,</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>              <span class="at">method.args=</span><span class="fu">list</span>(<span class="at">family=</span><span class="st">"binomial"</span>)) <span class="sc">+</span></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Exposure risk"</span>, <span class="at">y =</span> <span class="st">"infection"</span>,</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="cn">NULL</span>,</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Comparison"</span>)</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>((p1 <span class="sc">|</span> p2)<span class="sc">/</span> p3) <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">'collect'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="do">## random walk indiv's should just correlate with background (e_inf)</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>cw_risk<span class="sc">$</span>s_inf <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="dv">1</span>, cw_risk<span class="sc">$</span>susceptbility<span class="sc">*</span><span class="fu">mean</span>(cw_risk<span class="sc">$</span>exp_risk))</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>cw_risk<span class="sc">$</span>e_inf <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="dv">1</span>, cw_risk<span class="sc">$</span>susceptbility<span class="sc">*</span>cw_risk<span class="sc">$</span>exp_risk)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cw_risk) <span class="sc">+</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>exp_risk, <span class="at">y=</span>s_inf))<span class="sc">+</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x=</span>exp_risk, <span class="at">y=</span>s_inf, <span class="at">col=</span><span class="st">"without risk"</span>),</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">col=</span><span class="st">"#619CFF"</span>,</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">se=</span>F,</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"glm"</span>,</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">method.args=</span><span class="fu">list</span>(<span class="at">family=</span><span class="st">"binomial"</span>)) <span class="sc">+</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Exposure risk"</span>, <span class="at">y =</span> <span class="st">"infection"</span>,</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="cn">NULL</span>,</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Susceptibility only"</span>)</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cw_risk) <span class="sc">+</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>exp_risk, <span class="at">y=</span>e_inf))<span class="sc">+</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x=</span>exp_risk, <span class="at">y=</span>e_inf),</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">col=</span><span class="st">"#F8766D"</span>,</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">se=</span>F,</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"glm"</span>,</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">method.args=</span><span class="fu">list</span>(<span class="at">family=</span><span class="st">"binomial"</span>)) <span class="sc">+</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Exposure risk"</span>, <span class="at">y =</span> <span class="st">"infection"</span>,</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="cn">NULL</span>,</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Susceptibility * Risk"</span>)</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cw_risk) <span class="sc">+</span></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x=</span>exp_risk, <span class="at">y=</span>s_inf, <span class="at">col=</span><span class="st">"without risk"</span>),</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">se=</span>F,</span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"glm"</span>,</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">method.args=</span><span class="fu">list</span>(<span class="at">family=</span><span class="st">"binomial"</span>)) <span class="sc">+</span></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x=</span>exp_risk, <span class="at">y=</span>e_inf, <span class="at">col=</span><span class="st">"with risk"</span>),</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>              <span class="at">se=</span>F,</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"glm"</span>,</span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>              <span class="at">method.args=</span><span class="fu">list</span>(<span class="at">family=</span><span class="st">"binomial"</span>)) <span class="sc">+</span></span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Exposure risk"</span>, <span class="at">y =</span> <span class="st">"infection"</span>,</span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="cn">NULL</span>,</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Comparison"</span>)</span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>((p1 <span class="sc">|</span> p2)<span class="sc">/</span> p3) <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">'collect'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="replicate-that-many-times" class="level3">
<h3 class="anchored" data-anchor-id="replicate-that-many-times">replicate that many times</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Brownian</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="do">## random walk indiv's should just correlate with background (e_inf)</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>s_inf <span class="ot">&lt;-</span> <span class="fu">replicate</span>(trials, <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="dv">1</span>, rw_risk<span class="sc">$</span>susceptbility<span class="sc">*</span><span class="fu">mean</span>(rw_risk<span class="sc">$</span>exp_risk)))</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>s_inf <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(s_inf)<span class="sc">/</span>trials</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(s_inf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.00 0.06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>e_inf <span class="ot">&lt;-</span> <span class="fu">replicate</span>(trials, <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="dv">1</span>, rw_risk<span class="sc">$</span>susceptbility<span class="sc">*</span>rw_risk<span class="sc">$</span>exp_risk))</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>e_inf <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(e_inf)<span class="sc">/</span>trials</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(e_inf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.00 0.12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>rw_risk<span class="sc">$</span>s_inf <span class="ot">&lt;-</span> s_inf</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>rw_risk<span class="sc">$</span>e_inf <span class="ot">&lt;-</span> e_inf</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rw_risk) <span class="sc">+</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>exp_risk, <span class="at">y=</span>s_inf))<span class="sc">+</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x=</span>exp_risk, <span class="at">y=</span>s_inf, <span class="at">col=</span><span class="st">"without risk"</span>),</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">col=</span><span class="st">"#619CFF"</span>,</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">se=</span>F,</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"glm"</span>) <span class="sc">+</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Exposure risk"</span>, <span class="at">y =</span> <span class="st">"infection"</span>,</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="cn">NULL</span>,</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Susceptibility only"</span>)</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rw_risk) <span class="sc">+</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>exp_risk, <span class="at">y=</span>e_inf))<span class="sc">+</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x=</span>exp_risk, <span class="at">y=</span>e_inf),</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">col=</span><span class="st">"#F8766D"</span>,</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">se=</span>F,</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"glm"</span>) <span class="sc">+</span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Exposure risk"</span>, <span class="at">y =</span> <span class="st">"infection"</span>,</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="cn">NULL</span>,</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Susceptibility * Risk"</span>)</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rw_risk) <span class="sc">+</span></span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x=</span>exp_risk, <span class="at">y=</span>s_inf, <span class="at">col=</span><span class="st">"without risk"</span>),</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">se=</span>F,</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"glm"</span>) <span class="sc">+</span></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x=</span>exp_risk, <span class="at">y=</span>e_inf, <span class="at">col=</span><span class="st">"with risk"</span>),</span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">se=</span>F,</span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"glm"</span>) <span class="sc">+</span></span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Exposure risk"</span>, <span class="at">y =</span> <span class="st">"infection"</span>,</span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="cn">NULL</span>,</span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Comparison"</span>)</span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a>((p1 <span class="sc">|</span> p2)<span class="sc">/</span> p3) <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">'collect'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Corridor</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="do">## random walk indiv's should just correlate with background (e_inf)</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>s_inf <span class="ot">&lt;-</span> <span class="fu">replicate</span>(trials, <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="dv">1</span>, cw_risk<span class="sc">$</span>susceptbility<span class="sc">*</span><span class="fu">mean</span>(cw_risk<span class="sc">$</span>exp_risk)))</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>s_inf <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(s_inf)<span class="sc">/</span>trials</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(s_inf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.00 0.05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>e_inf <span class="ot">&lt;-</span> <span class="fu">replicate</span>(trials, <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="dv">1</span>, cw_risk<span class="sc">$</span>susceptbility<span class="sc">*</span>cw_risk<span class="sc">$</span>exp_risk))</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>e_inf <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(e_inf)<span class="sc">/</span>trials</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(e_inf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.00 0.09</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>cw_risk<span class="sc">$</span>s_inf <span class="ot">&lt;-</span> s_inf</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>cw_risk<span class="sc">$</span>e_inf <span class="ot">&lt;-</span> e_inf</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cw_risk) <span class="sc">+</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>exp_risk, <span class="at">y=</span>s_inf))<span class="sc">+</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x=</span>exp_risk, <span class="at">y=</span>s_inf, <span class="at">col=</span><span class="st">"without risk"</span>),</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">col=</span><span class="st">"#619CFF"</span>,</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">se=</span>F,</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"glm"</span>) <span class="sc">+</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Exposure risk"</span>, <span class="at">y =</span> <span class="st">"infection"</span>,</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="cn">NULL</span>,</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Susceptibility only"</span>)</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cw_risk) <span class="sc">+</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>exp_risk, <span class="at">y=</span>e_inf))<span class="sc">+</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x=</span>exp_risk, <span class="at">y=</span>e_inf),</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">col=</span><span class="st">"#F8766D"</span>,</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">se=</span>F,</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"glm"</span>) <span class="sc">+</span></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Exposure risk"</span>, <span class="at">y =</span> <span class="st">"infection"</span>,</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="cn">NULL</span>,</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Susceptibility * Risk"</span>)</span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cw_risk) <span class="sc">+</span></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x=</span>exp_risk, <span class="at">y=</span>s_inf, <span class="at">col=</span><span class="st">"without risk"</span>),</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">se=</span>F,</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"glm"</span>) <span class="sc">+</span></span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x=</span>exp_risk, <span class="at">y=</span>e_inf, <span class="at">col=</span><span class="st">"with risk"</span>),</span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">se=</span>F,</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"glm"</span>) <span class="sc">+</span></span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Exposure risk"</span>, <span class="at">y =</span> <span class="st">"infection"</span>,</span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="cn">NULL</span>,</span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Comparison"</span>)</span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a>((p1 <span class="sc">|</span> p2)<span class="sc">/</span> p3) <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">'collect'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>compare the fit of the susceptibility * risk for the two types of walks</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(e_inf <span class="sc">~</span> exp_risk, <span class="at">data=</span>rw_risk)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(e_inf <span class="sc">~</span> exp_risk, <span class="at">data=</span>cw_risk)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6199239</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.552703</code></pre>
</div>
</div>
<p>It is worse with more variability in movement (corridor walk) but this is to be expected.</p>


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{kauffman2023,
  author = {Kauffman, Kayla},
  title = {Simulation of {Realized} {Infection} {Risk}},
  date = {2023-11-29},
  url = {https://https://kmkauffm.github.io//posts/2023-11-29-realizedrisk/},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-kauffman2023" class="csl-entry quarto-appendix-citeas" role="listitem">
Kauffman, Kayla. 2023. <span>“Simulation of Realized Infection
Risk.”</span> November 29, 2023. <a href="https://https://kmkauffm.github.io//posts/2023-11-29-realizedrisk/">https://https://kmkauffm.github.io//posts/2023-11-29-realizedrisk/</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">Copyright 2023, Kayla Kauffman</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>