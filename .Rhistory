#| echo: false
#| message: false
# library(spDataLarge)
library(tidyverse)
library(sf)
library(terra)
library(SiMRiv)
library(patchwork)
theme_set(theme_bw())
theme_update(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5))
## load the data from the spDataLarge package
riskmap <- rast(system.file("raster/srtm.tif", package = "spDataLarge"))
## project in utm so easier units for making the simulated tracks
riskmap <- project(riskmap, "EPSG:26912")
## make values [0,1]
riskmap <- riskmap/max(values(riskmap), na.rm=T)
## most places should be pretty low
## look at the 'original values'
ggplot() +
stars::geom_stars(data = stars::st_as_stars(riskmap)) +
scale_fill_viridis_c() +
coord_fixed() +
labs(x=NULL, y=NULL, fill = "elevation scaled [0,1]", title = "Origional Elevation Map") +
theme(axis.text = element_blank()) # since don't care about location
## histogram of value distribution
p1 <- as.data.frame(values(riskmap)) %>%
filter(is.finite(srtm)) %>%
ggplot() +
geom_histogram(aes(x=srtm)) +
labs(x = "cell values", y = "frequency", title = "Origional risk map values [0,1]")
## add right skew to values so most are low
riskmap <- riskmap^3
## plots to commpare old and new value distributions
p2 <- as.data.frame(values(riskmap)) %>%
filter(is.finite(srtm)) %>%
ggplot() +
geom_histogram(aes(x=srtm)) +
labs(x = "cell values", y = "frequency", title = "Skewed risk map values [0,1]")
## plot old and new next to each other
p1+p2
values(riskmap)
s.data.frame(values(riskmap))
as.data.frame(values(riskmap))
## histogram of value distribution
p1 <- values(riskmap) %>%
as.data.frame() %>%
filter(is.finite(srtm)) %>%
ggplot() +
geom_histogram(aes(x=srtm)) +
labs(x = "cell values", y = "frequency", title = "Origional risk map values [0,1]")
